---
# Must present
author: Ruoqing He
title: Runic Quanta
# Optional
date: 2024-03-13
summary: A distributed binary object storage system.
---

```Rust
//  ____              _         ___                    _        
// |  _ \ _   _ _ __ (_) ___   / _ \ _   _  __ _ _ __ | |_ __ _ 
// | |_) | | | | '_ \| |/ __| | | | | | | |/ _` | '_ \| __/ _` |
// |  _ <| |_| | | | | | (__  | |_| | |_| | (_| | | | | || (_| |
// |_| \_\\__,_|_| |_|_|\___|  \__\_\\__,_|\__,_|_| |_|\__\__,_|
```
##

```Rust
//                  In Program                          Objects On Stack            Objects On Heap    
// +------------------------------------------+      +--------------------+      +--------------------+
// |                                          |      |                    |      |                    |
// |                                          |      | 0  big_object.ptr--+----->| 0     00000001     |
// |  let big_object = vec![1; u16::MAX]; ----+----->| 1  big_object.cap  |      | 1     00000001     |
// |  // `big_object` in memory               |      | 2  big_object.len  |      | 2     00000001     |
// |                                          |      | 3                  |      |       ...  ...     |
// |                                          |      | 4                  |      | 65534 00000001     |
// |                                          |      | 5                  |      | 65535 00000001     |
// |                                          |      |       ...  ...     |      |                    |
// +------------------------------------------+      +--------------------+      +--------------------+
//                                                                                                     
//                                                                                                     
//                                                                                                     
//                  In Program                          Objects On Stack            Objects On Heap    
// +------------------------------------------+      +--------------------+      +--------------------+
// |                                          |      |                    |      |                    |
// |                                          |      | 0  big_object.ptr--+----->| 0     00000000     |
// |  // `big_object`'s actual content        |  +-->| 1  big_object.cap  |      | 1     00000000     |
// |  // is now stored in cluster             |  |   | 2  big_object.len  |      | 2     00000000     |
// |  rq_stash!(big_object); -----------------+--+   | 3                  |      | 3     00000000     |
// |                |                         |      | 4                  |      | 4     00000000     |
// |                |                         |      | 5                  |      | 5     00000000     |
// |                |                         |      |       ...  ...     |      |       ...  ...     |
// +----------------+-------------------------+      +--------------------+      +--------------------+
//                  |                                                                                  
//                  |                                              Runic Quanta                        
//                  |                         +-------------------------------------------------------+
//                  |                         |                                                       |
//                  |                         |   +-----------------------------------------------+   |
//                  |                         |   |                                               |   |
//                  |                         |   |                  RQ Master                    |   |
//                  +-------------------------+-->|                                               |   |
//                                            |   |                                               |   |
//                                            |   +------+----------------+----------------+------+   |
//                                            |          |                |                |          |
//                                            |          |                |                |          |
//                                            |   +------v------+  +------v------+  +------v------+   |
//                                            |   |             |  |             |  |             |   |
//                                            |   |  RQ Worker  |  |  RQ Worker  |  |  RQ Worker  |   |
//                                            |   |             |  |             |  |             |   |
//                                            |   +-------------+  +-------------+  +-------------+   |
//                                            |                                                       |
//                                            +-------------------------------------------------------+
//                                                                                                     
//                                                                                                     
//                                                                                                     
//                  In Program                          Objects On Stack            Objects On Heap    
// +------------------------------------------+      +--------------------+      +--------------------+
// |                                          |      |                    |      |                    |
// |                                          |      | 0  big_object.ptr--+----->| 0     00000001     |
// |  // `big_object`'s is to be loaded       |  +-->| 1  big_object.cap  |      | 1     00000001     |
// |  // from cluster, this is blocking       |  |   | 2  big_object.len  |      | 2     00000001     |
// |  rq_reveal!(big_object);-----------------+--+   | 3                  |      |       ...00...     |
// |                 ^                        |      | 4                  |      | 65534 00000001     |
// |                 |                        |      | 5                  |      | 65535 00000001     |
// |                 |                        |      |       ...  ...     |      |       ...  ...     |
// +-----------------+------------------------+      +--------------------+      +--------------------+
//                   |                                                                                 
//                   |                                             Runic Quanta                        
//                   |                        +-------------------------------------------------------+
//                   |                        |                                                       |
//                   |                        |   +-----------------------------------------------+   |
//                   |                        |   |                                               |   |
//                   |                        |   |                  RQ Master                    |   |
//                   +------------------------+---+                                               |   |
//                                            |   |                                               |   |
//                                            |   +-----------------------------------------------+   |
//                                            |          ^                ^                ^          |
//                                            |          |                |                |          |
//                                            |   +------+------+  +------+------+  +------+------+   |
//                                            |   |             |  |             |  |             |   |
//                                            |   |  RQ Worker  |  |  RQ Worker  |  |  RQ Worker  |   |
//                                            |   |             |  |             |  |             |   |
//                                            |   +-------------+  +-------------+  +-------------+   |
//                                            |                                                       |
//                                            +-------------------------------------------------------+
```

```Rust
//                  In Program                          Objects On Stack            Objects On Heap    
// ┌──────────────────────────────────────────┐      ┌────────────────────┐      ┌────────────────────┐
// │                                          │      │                    │      │                    │
// │                                          │      │ 0  big_object.ptr──┼─────►│ 0     00000001     │
// │  let big_object = vec![1; u16::MAX]; ────┼─────►│ 1  big_object.cap  │      │ 1     00000001     │
// │  // `big_object` in memory               │      │ 2  big_object.len  │      │ 2     00000001     │
// │                                          │      │ 3                  │      │       ...  ...     │
// │                                          │      │ 4                  │      │ 65534 00000001     │
// │                                          │      │ 5                  │      │ 65535 00000001     │
// │                                          │      │       ...  ...     │      │                    │
// └──────────────────────────────────────────┘      └────────────────────┘      └────────────────────┘
//                                                                                                     
//                                                                                                     
//                                                                                                     
//                  In Program                          Objects On Stack            Objects On Heap    
// ┌──────────────────────────────────────────┐      ┌────────────────────┐      ┌────────────────────┐
// │                                          │      │                    │      │                    │
// │                                          │      │ 0  big_object.ptr──┼─────►│ 0     00000000     │
// │  // `big_object`'s actual content        │  ┌──►│ 1  big_object.cap  │      │ 1     00000000     │
// │  // is now stored in cluster             │  │   │ 2  big_object.len  │      │ 2     00000000     │
// │  rq_stash!(big_object); ─────────────────┼──┘   │ 3                  │      │ 3     00000000     │
// │                │                         │      │ 4                  │      │ 4     00000000     │
// │                │                         │      │ 5                  │      │ 5     00000000     │
// │                │                         │      │       ...  ...     │      │       ...  ...     │
// └────────────────┼─────────────────────────┘      └────────────────────┘      └────────────────────┘
//                  │                                                                                  
//                  │                                              Runic Quanta                        
//                  │                         ┌───────────────────────────────────────────────────────┐
//                  │                         │                                                       │
//                  │                         │   ┌───────────────────────────────────────────────┐   │
//                  │                         │   │                                               │   │
//                  │                         │   │                  RQ Master                    │   │
//                  └─────────────────────────┼──►│                                               │   │
//                                            │   │                                               │   │
//                                            │   └──────┬────────────────┬────────────────┬──────┘   │
//                                            │          │                │                │          │
//                                            │          │                │                │          │
//                                            │   ┌──────▼──────┐  ┌──────▼──────┐  ┌──────▼──────┐   │
//                                            │   │             │  │             │  │             │   │
//                                            │   │  RQ Worker  │  │  RQ Worker  │  │  RQ Worker  │   │
//                                            │   │             │  │             │  │             │   │
//                                            │   └─────────────┘  └─────────────┘  └─────────────┘   │
//                                            │                                                       │
//                                            └───────────────────────────────────────────────────────┘
//                                                                                                     
//                                                                                                     
//                                                                                                     
//                  In Program                          Objects On Stack            Objects On Heap    
// ┌──────────────────────────────────────────┐      ┌────────────────────┐      ┌────────────────────┐
// │                                          │      │                    │      │                    │
// │                                          │      │ 0  big_object.ptr──┼─────►│ 0     00000001     │
// │  // `big_object`'s is to be loaded       │  ┌──►│ 1  big_object.cap  │      │ 1     00000001     │
// │  // from cluster, this is blocking       │  │   │ 2  big_object.len  │      │ 2     00000001     │
// │  rq_reveal!(big_object);─────────────────┼──┘   │ 3                  │      │       ...00...     │
// │                 ▲                        │      │ 4                  │      │ 65534 00000001     │
// │                 │                        │      │ 5                  │      │ 65535 00000001     │
// │                 │                        │      │       ...  ...     │      │       ...  ...     │
// └─────────────────┼────────────────────────┘      └────────────────────┘      └────────────────────┘
//                   │                                                                                 
//                   │                                             Runic Quanta                        
//                   │                        ┌───────────────────────────────────────────────────────┐
//                   │                        │                                                       │
//                   │                        │   ┌───────────────────────────────────────────────┐   │
//                   │                        │   │                                               │   │
//                   │                        │   │                  RQ Master                    │   │
//                   └────────────────────────┼───┤                                               │   │
//                                            │   │                                               │   │
//                                            │   └───────────────────────────────────────────────┘   │
//                                            │          ▲                ▲                ▲          │
//                                            │          │                │                │          │
//                                            │   ┌──────┴──────┐  ┌──────┴──────┐  ┌──────┴──────┐   │
//                                            │   │             │  │             │  │             │   │
//                                            │   │  RQ Worker  │  │  RQ Worker  │  │  RQ Worker  │   │
//                                            │   │             │  │             │  │             │   │
//                                            │   └─────────────┘  └─────────────┘  └─────────────┘   │
//                                            │                                                       │
//                                            └───────────────────────────────────────────────────────┘
```