---
# Must present
author: Ruoqing He
title: Basics
# Optional
date: 2024-03-13
summary: Basic knowledge for interview.
---

## 计算机网络

### 网络层

网络层实现主机之间的通信，链路层实现具体每段链路之间的通信。因此在通信过程中，IP数据报的源地址和目的地址（IP地址）始终不变，而MAC地址随着链路的改变而改变（具体的设备上的通信网卡）。

#### IP数据报格式

- 版本：IPv4 或 IPv6
- 首部长度
- 总长度
- 生存时间：TTL，防止无法交付的数据报在互联网中占用资源。以路由器跳数为单位，当TTL为0时丢弃数据报
- 协议：TCP，UDP，ICMP，IGMP，ARP，RARP
- 首部校验和：每经由一个路由器都需要重新计算校验和
- 标识：分片情况下，相同数据报的不同分片具有相同的标识符
- 片偏移：分片情况下启用，单位为8字节

#### IP地址编址方式

1. 分类：ABCDE类
2. 子网划分
3. 无分类：CIDR

#### ARP地址解析协议

ARP实现由IP地址得到MAC地址。

每个主机都有一个ARP高速缓存，里面有本局域网上的各主机和路由器的IP地址到MAC地址的映射表。如果对方的MAC地址未知（也不在高速缓存内），该主机通过广播方式发送ARP请求分组，对方主机收到该请求后会发送ARP响应分组给该主机，告知其MAC地址，随后该主机会将该映射写入高速缓存。

#### ICMP网际控制报文协议

ICMP是为更有效地转发IP数据报和提高交付成功的机会。被封装在IP数据报中，但不属于高层协议。

ICMP分为：
- 差错报告报文：
  1. 3：终点不可达
  2. 11：超时
  3. 12：参数问题
  4. 5：改变路由（Redirect）
- 询问报文：
  1. 0或8：Echo回答或请求
  2. 13或14：Timestamp请求或回答

Ping: 是ICMP的一个重要应用，主要用来来测试两台主机之间的连通性。原理是通过向目的主机发送ICMP Echo请求报文，目的主机收到之后发回Echo回答报文。Ping会根据时间和成功响应的次数估算出数据报往返时间以及丢包率。

#### 路由器的结构

功能划分：路由选择，分组转发

分组转发由：
- 交换结构
- 输入端口
- 输出端口

其中，这些端口都为队列，当队满时到达的报文会被丢弃，出现丢包的现象。
